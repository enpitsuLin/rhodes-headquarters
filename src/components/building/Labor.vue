<script setup lang="ts">
import type { Labor } from '~/types/building'

const props = defineProps<{ data: Labor }>()

const drone = computed(() => {
  return Math.min(Math.round((Date.now() / 1000 - props.data.lastUpdateTime) / 360 + props.data.value), props.data.maxValue)
})
</script>

<template>
  <div
    border="b border"
    p-4px flex="~ items-center gap-8px"
  >
    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M5 10V9.85355C5 9.62718 4.91007 9.41007 4.75 9.25C4.58993 9.08993 4.5 8.87282 4.5 8.64645V8.35355C4.5 8.12718 4.58993 7.91007 4.75 7.75C4.91007 7.58993 5 7.37282 5 7.14645V7C5 6.67986 4.87282 6.37282 4.64645 6.14645L3.06066 4.56066C2.47487 3.97487 1.52513 3.97487 0.93934 4.56066L0.603553 4.89645C0.537249 4.96275 0.447322 5 0.353553 5C0.158291 5 0 4.84171 0 4.64645C0 4.55268 0.0372492 4.46275 0.103553 4.39645L3.89645 0.603553C3.96275 0.537249 4.05268 0.5 4.14645 0.5C4.34171 0.5 4.5 0.658291 4.5 0.853553C4.5 0.947322 4.46275 1.03725 4.39645 1.10355L4.06066 1.43934C3.47487 2.02513 3.47487 2.97487 4.06066 3.56066L4.91421 4.41421C5.28929 4.78929 5.79799 5 6.32843 5H7.29289C7.4255 5 7.55268 4.94732 7.64645 4.85355C7.84171 4.65829 8.15829 4.65829 8.35355 4.85355C8.44732 4.94732 8.5745 5 8.70711 5H9.67157C10.202 5 10.7107 4.78929 11.0858 4.41421L11.9393 3.56066C12.5251 2.97487 12.5251 2.02513 11.9393 1.43934L11.6036 1.10355C11.5372 1.03725 11.5 0.947322 11.5 0.853553C11.5 0.658291 11.6583 0.5 11.8536 0.5C11.9473 0.5 12.0372 0.537249 12.1036 0.603553L15.8964 4.39645C15.9628 4.46275 16 4.55268 16 4.64645C16 4.84171 15.8417 5 15.6464 5C15.5527 5 15.4628 4.96275 15.3964 4.89645L15.0607 4.56066C14.4749 3.97487 13.5251 3.97487 12.9393 4.56066L11.3536 6.14645C11.1272 6.37282 11 6.67986 11 7V7.14645C11 7.37282 11.0899 7.58993 11.25 7.75C11.4101 7.91007 11.5 8.12718 11.5 8.35355V8.64645C11.5 8.87282 11.4101 9.08993 11.25 9.25C11.0899 9.41007 11 9.62718 11 9.85355V10C11 10.3201 11.1272 10.6272 11.3536 10.8536L12.9393 12.4393C13.5251 13.0251 14.4749 13.0251 15.0607 12.4393L15.3964 12.1036C15.4628 12.0372 15.5527 12 15.6464 12C15.8417 12 16 12.1583 16 12.3536C16 12.4473 15.9628 12.5372 15.8964 12.6036L12.1036 16.3964C12.0372 16.4628 11.9473 16.5 11.8536 16.5C11.6583 16.5 11.5 16.3417 11.5 16.1464C11.5 16.0527 11.5372 15.9628 11.6036 15.8964L11.9393 15.5607C12.5251 14.9749 12.5251 14.0251 11.9393 13.4393L10.5303 12.0303C10.1908 11.6908 9.73022 11.5 9.25 11.5H8.70711C8.5745 11.5 8.44732 11.5527 8.35355 11.6464C8.15829 11.8417 7.84171 11.8417 7.64645 11.6464C7.55268 11.5527 7.4255 11.5 7.29289 11.5H6.75C6.26978 11.5 5.80923 11.6908 5.46967 12.0303L4.06066 13.4393C3.47487 14.0251 3.47487 14.9749 4.06066 15.5607L4.39645 15.8964C4.46275 15.9628 4.5 16.0527 4.5 16.1464C4.5 16.3417 4.34171 16.5 4.14645 16.5C4.05268 16.5 3.96275 16.4628 3.89645 16.3964L0.103553 12.6036C0.0372493 12.5372 0 12.4473 0 12.3536C0 12.1583 0.158291 12 0.353553 12C0.447322 12 0.537249 12.0372 0.603553 12.1036L0.93934 12.4393C1.52513 13.0251 2.47487 13.0251 3.06066 12.4393L4.64645 10.8536C4.87282 10.6272 5 10.3201 5 10Z" fill="#DC92FF" />
    </svg>
    <span>
      <span class="text-#dc92ff">{{ drone }}</span>/{{ data.maxValue }}
    </span>
  </div>
</template>
