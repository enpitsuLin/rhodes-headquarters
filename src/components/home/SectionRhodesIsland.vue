<script setup lang="ts">
import { Tabs } from '@ark-ui/vue'
import { useScroll } from '@vueuse/core'
import { storeToRefs } from 'pinia'
import SectionTitle from './SectionTitle.vue'
import Labor from '~/components/building/Labor.vue'
import BuildingList from '~/components/building/List.vue'
import HireRfreshCount from '~/components/recruit/HireRfreshCount.vue'
import RecruitList from '~/components/recruit/List.vue'
import { useAccountsStore } from '~/store/account'

const { info } = storeToRefs(useAccountsStore())

const el = ref<HTMLElement | null>(null)
const { arrivedState } = useScroll(el)
</script>

<template>
  <Tabs.Root as-child default-value="公招" h-300px>
    <section flex="~ col">
      <SectionTitle title="罗德岛" sub="Rhodes Island">
        <Tabs.List
          flex="~ items-center justify-between"
          relative box-content bg-background p-1px border="~ border rounded-full"
        >
          <Tabs.Indicator h="$height" w="$width" rounded-full bg-primary />
          <Tabs.Trigger value="公招" relative w-60px>
            公招
          </Tabs.Trigger>
          <Tabs.Trigger value="基建" relative w-60px>
            基建
          </Tabs.Trigger>
        </Tabs.List>
      </SectionTitle>
      <div relative h-270px of-hidden class="after:(absolute inset-x-0 bottom-0 h-1px bg-border content-empty)">
        <Tabs.Content value="公招" h-full>
          <div flex="~ col" h-full>
            <HireRfreshCount />
            <div relative flex="~ 1 col justify-between">
              <div absolute bottom-0 left-0 c-border>
                <svg width="274" height="184" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M43.282 33.788c.515 1.482 1.601 4.728 1.77 6.368.114 1.108-.567 2.061-.952 2.79-.321.605-.228 1.145-.35 1.484L60.464 57.49l4.986-6.381-22.168-17.32ZM43.238 44.994c-.716.554-1.974 1.254-3.31 2.4-3.006 2.572-15.036 15.72-18.06 19.465L41.29 82.032l18.708-23.945-16.759-13.093ZM18.91 65.933c-.314-.246-.796.025-1.082.39-.618.791.66 3.017-1.064 5.224-2.088 2.673-5.42 4.991-11.145 7.664C.644 81.534-4.9 82.126-6.256 83.864c-1.2 1.535-.142 3.4-.142 3.4l27.072 21.152 19.942-25.525L18.91 65.933ZM-11.088 84.99c-1.47-1.148-6.228.712-6.996 1.694-.468.599-.675 1.026-.768 1.269l34.473 26.933 4.38-5.606-31.089-24.29Z" fill="currentColor" />
                  <path d="M13.69 69.144c1.724-2.207.444-4.434 1.062-5.224.286-.367.768-.637 1.084-.39l-2.877-2.248c-.315-.246-.797.025-1.083.39-.617.792.66 3.017-1.064 5.224-2.088 2.673-5.615 3.876-11.546 6.22-5.1 2.018-12.565 2.447-13.922 4.184-1.2 1.536-1.239 2.544-1.239 2.544l6.423 5.018s-1.06-1.867.14-3.402c1.357-1.738 6.897-2.33 11.876-4.651 5.722-2.673 9.057-4.992 11.145-7.665ZM41.397 40.833c.385-.726 1.064-1.683.951-2.787-.168-1.643-1.253-4.888-1.77-6.37l-2.748-2.149c.516 1.483 1.602 4.73 1.77 6.37.114 1.106-.567 2.062-.953 2.788-.322.607-.227 1.148-.35 1.484l2.748 2.147c.123-.337.03-.875.352-1.483ZM50.767 15.444C46.295 18.494 37.76 28.51 37.76 28.51l2.75 2.147 11.46-13.819-1.203-1.394ZM37.976 40.883c-.716.553-2.535 1.89-3.873 3.035-3.005 2.574-14.02 13.13-18.535 18.018l3.598 2.811c3.02-3.746 15.05-16.895 18.06-19.466 1.335-1.145 2.595-1.844 3.31-2.399l-2.56-2ZM63.79 27.77l-3.04 3.89-3.533-2.761 3.038-3.89-6.435-5.028-10.608 12.788 22.706 17.74 10.225-13.087L63.79 27.77ZM205.265 138.302l-14.379 18.405 3.283-27.074-6.054-4.73-21.046 26.937 5.599 4.375 14.378-18.402-3.285 27.068 6.054 4.73 21.046-26.937-5.596-4.372ZM95.078 52.215l-8.791 11.252-10.292-8.041 8.79-11.252-5.597-4.373-21.045 26.937 5.597 4.373 8.45-10.815 10.291 8.041-8.449 10.815 5.597 4.373 21.046-26.937-5.597-4.373ZM155.779 127.566l10.445-6.348-3.63 11.673-6.815-5.325Zm2.943 17.753 5.6 4.374 10.863-34.892-4.9-3.828-31.231 18.979 5.601 4.376 5.476-3.328 10.497 8.201-1.906 6.118ZM121.746 73.05l-12.327 15.778c-2.306 2.951-6.482 3.543-9.322 1.325-2.842-2.22-3.276-6.414-.97-9.366l12.327-15.778-5.597-4.373L93.53 76.414c-4.816 6.164-3.91 14.916 2.024 19.553 5.935 4.636 14.646 3.398 19.462-2.766l12.327-15.777-5.597-4.374ZM152.193 96.838l-.118-.092-17.398 7.903 3.462-18.79-.119-.094-5.601-4.376-21.046 26.937 5.601 4.376 13.435-17.196-2.805 15.227 2.882 2.252 14.095-6.404-13.433 17.194 5.599 4.375 21.045-26.937-5.599-4.375ZM169.681 158.132l-12.327 15.778c-2.306 2.951-6.482 3.543-9.322 1.324-2.843-2.221-3.276-6.414-.97-9.365l12.327-15.778-5.599-4.374-12.327 15.777c-4.816 6.165-3.908 14.918 2.026 19.555 5.935 4.636 14.644 3.397 19.461-2.768l12.326-15.777-5.595-4.372ZM57.808 78.75l4.659 3.66c1.961 1.544 2.257 4.442.655 6.482-1.602 2.036-4.49 2.439-6.45.899l-4.66-3.662 5.796-7.379Zm-3.11 33.012 2.98-14.503c3.911.837 8.212-.599 10.93-4.059 3.747-4.775 3.064-11.574-1.535-15.184l-10.96-8.614-21.112 26.885 5.588 4.389 7.53-9.59 3.736 2.936-2.744 13.353 5.587 4.387ZM183.4 176.874l4.659 3.66c1.958 1.541 2.255 4.44.652 6.478-1.599 2.039-4.486 2.442-6.449.9l-4.659-3.66 5.797-7.378Zm-3.112 33.01 2.981-14.503c3.913.839 8.212-.598 10.927-4.06 3.75-4.774 3.064-11.574-1.532-15.182l-10.958-8.613-21.116 26.882 5.59 4.39 7.529-9.59 3.738 2.937-2.747 13.35 5.588 4.389ZM94.159 107.744l4.18-5.351-17.83-13.93-21.047 26.936 17.831 13.931 4.178-5.347-12.23-9.555 4.442-5.686 10.236 7.997 3.805-4.871-10.235-7.997 4.44-5.683 12.23 9.556ZM103.878 124.718c-2.169-1.695-2.774-4.542-1.352-6.362 1.422-1.819 4.331-1.922 6.5-.227 2.167 1.694 2.677 4.705 1.54 6.778l6.102 2.538c2.248-4.319.63-10.239-4.059-13.902-5.185-4.051-12.144-3.808-15.545.546-3.402 4.353-1.954 11.164 3.231 15.216 2.167 1.693 2.772 4.541 1.35 6.36-1.421 1.82-4.332 1.924-6.5.23-2.169-1.694-2.763-4.294-1.274-8.129l-5.894-1.99c-2.919 4.359-1.402 10.807 3.587 14.704 5.183 4.05 12.144 3.808 15.543-.542 3.402-4.356 1.955-11.17-3.229-15.22ZM120.819 154.375c-4.202-3.283-4.845-9.483-1.436-13.847 3.41-4.364 9.585-5.243 13.786-1.961 4.202 3.283 4.841 9.485 1.431 13.85-3.409 4.364-9.58 5.241-13.781 1.958Zm16.697-21.372c-7.163-5.596-17.679-4.1-23.491 3.339-5.81 7.436-4.717 18.002 2.446 23.599 7.161 5.594 17.677 4.098 23.487-3.338 5.812-7.439 4.719-18.005-2.442-23.6ZM61.953 129.033l-2.294-1.792-2.836 3.63 2.294 1.793c.967.755 2.383.554 3.167-.45.783-1.003.636-2.426-.33-3.181ZM65.59 141.661l3.348 2.616 1.786-5.734-5.133 3.118ZM84.272 146.493l-2.287-1.801-2.846 3.625 2.288 1.8c.965.757 2.38.56 3.17-.443.785-1.001.64-2.427-.325-3.181ZM36.446 109.577l-2.292-1.791-6.069 7.767 2.293 1.791c2.066 1.615 5.097 1.187 6.775-.96 1.675-2.144 1.36-5.193-.707-6.807Z" fill="currentColor" />
                  <path d="m151.265 199.389-3.926-3.067-8.154 10.436-2.753-2.151 8.154-10.436-3.926-3.067 2.188-2.801 10.605 8.286-2.188 2.8Zm-19.95 1.211-2.975-2.324 1.613-13.296-7.062 9.039-2.754-2.152 10.337-13.231 2.979 2.327-1.617 13.3 7.065-9.043 2.751 2.149-10.337 13.231Zm-5.953-21.729-6.008-4.694-2.183 2.793 5.03 3.93-1.87 2.394-5.03-3.93-2.181 2.792 6.008 4.694-2.052 2.626-8.757-6.842 10.338-13.231 8.757 6.842-2.052 2.626Zm-19.91 1.523-2.753-2.15 6.598-8.445-6.922 3.143-1.416-1.106 1.376-7.478-6.598 8.446-2.75-2.148 10.338-13.231 2.749 2.147.058.046-1.699 9.231 8.544-3.884.06.047 2.752 2.151-10.337 13.231Zm-5.463-21.066-3.924-3.066-8.154 10.436-2.75-2.149 8.153-10.436-3.928-3.069 2.188-2.8 10.603 8.284-2.188 2.8Zm-22.275-.573 1.348-6.56-1.835-1.442-3.7 4.712-2.745-2.158 10.372-13.204 5.383 4.228c2.256 1.774 2.594 5.114.753 7.46-1.335 1.698-3.447 2.403-5.367 1.993l-1.466 7.127-2.743-2.156Zm-10.675-8.372.936-3.007-5.158-4.029-2.69 1.635-2.752-2.149 15.342-9.322 2.405 1.879-5.334 17.141-2.749-2.148Zm-9.476-15.005-2.645-2.066-3.688 4.72-2.75-2.15 10.337-13.231 1.196.934 1.555 1.215 2.645 2.067c2.263 1.768 2.609 5.106.773 7.455-1.838 2.352-5.16 2.825-7.423 1.056Zm-3.508-12.218-6.008-4.694-2.182 2.794 5.028 3.928-1.87 2.393-5.028-3.928-2.181 2.792 6.008 4.694-2.052 2.626-8.76-6.843 10.338-13.231 8.76 6.843-2.053 2.626Zm-25.814-3.081-5.042-3.939 10.342-13.237 5.042 3.939c3.52 2.751 4.056 7.943 1.202 11.596-2.857 3.657-8.023 4.391-11.544 1.641Zm-9.574-2.813 124.517 97.283 14.852-19.01L33.519 98.256l-14.852 19.01Z" fill="currentColor" />
                </svg>
              </div>
              <RecruitList :data="info?.recruit ?? []" />
            </div>
          </div>
        </Tabs.Content>
        <Tabs.Content value="基建" relative h-full>
          <div flex="~ col" h-full>
            <Labor v-if="info" :data="info.building.labor" />
            <div ref="el" flex-1 of-x-hidden of-y-scroll pt-4px>
              <div flex="~ col items-center gap-4px">
                <BuildingList v-if="info" :info="info" />
              </div>
              <div v-show="!arrivedState.bottom" absolute inset-x-0 bottom-0 h-30px class="from-background to-transparent bg-gradient-to-t" />
            </div>
          </div>
        </Tabs.Content>
      </div>
    </section>
  </Tabs.Root>
</template>

<style>
.recruit-bg {
  background-image: repeating-linear-gradient(90deg, rgba(255, 255, 255, 0.1) 0, rgba(255, 255, 255, 0.1) 1px, transparent 1px, transparent 5px);
  background-size: rgba(17, 17, 17, 0.3);
}
</style>
